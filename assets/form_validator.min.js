var Validator=(function(){function a(){this._validations=[];this.errors=new a.Errors()}a.fn=a.prototype;a.getValidatorName=function(d){var c=d.replace(/[-_](.)/g,b).replace(/^(.)/,b);return c+"Validator"};a.getValidatorConstructor=function(c){return a[a.getValidatorName(c)]};a.fn.validate=function(d,e,c){this._validations.push({type:d,attribute:e,options:c||{}})};a.fn.isValid=function(c){this.errors.clean();this._validations.forEach(function(d){var f=a.getValidatorConstructor(d.type);var e=new f(c,d.attribute,d.options);if(!e.isValid()){this.errors.add(d.attribute,e.errorMessage())}},this);return this.errors.isEmpty()};var b=function(c,d){return d.toUpperCase()};return a})();Validator.Errors=(function(){function a(){this._messages={}}a.fn=a.prototype;a.fn.length=0;a.fn.clean=function(){this._messages={};this.length=0};a.fn.add=function(c,b){if(!this._messages[c]){this._messages[c]=[];this.length+=1}this._messages[c].push(b)};a.fn.isEmpty=function(){return this.length===0};a.fn.all=function(){return this._messages};a.fn.on=function(b){return this._messages[b]||[]};return a})();Validator.addValidator=function(b,c,e){var a=Validator.getValidatorName(b);var d;d=Validator[a]=function(f,h,g){this.record=f;this.attribute=h;this.options=g;this.defaultMessage=c};d.prototype.errorMessage=function(){return this.options.message||this.defaultMessage};d.prototype.isValid=e};Validator.addValidator("presence","can't be blank",function(){var a=this.record[this.attribute];return !!a&&!!a.replace(/\s/mg,"")});Validator.addValidator("format","is an invalid format",function(){var a=this.record[this.attribute]||"";return !!a.match(this.options.format)});Validator.addValidator("confirmation","must be equal to the confirmation",function(){var a=this.attribute+"_confirmation";var b=this.record[a]||"";var c=this.record[this.attribute]||"";return c==b});Validator.addValidator("length",null,function(){var d=this.record[this.attribute]||"";var c=d.length;var e=true;var a;var b=this.options.message||{};this.defaultMessage={min:"can't have less than "+this.options.min+" characters",max:"can't have more than "+this.options.max+" characters"};if(this.options.min&&d.length<this.options.min){e=false;a=b.min||this.defaultMessage.min}else{if(this.options.max&&d.length>this.options.max){e=false;a=b.max||this.defaultMessage.max}}this.errorMessage=function(){return a};return e});Validator.Form=(function(){var b=function(e,d,c){return function(f){return f[e].apply(d||f,c)}};function a(d,c){this.form=d;this.renderers=c||[];this._validator=new Validator();this.errors=this._validator.errors}a.fn=a.prototype;a.fn.validate=function(d,e,c){this._validator.validate(d,this.form.find(e).attr("name"),c)};a.fn.clean=function(){this.renderers.map(b("clean",null,[this]))};a.fn.render=function(){this.renderers.map(b("render",null,[this]))};a.fn.isValid=function(){var d=this._record();var c=this._validator.isValid(d);this.clean();if(!c){this.render()}return c};a.fn._record=function(){var c=this.form.serializeArray();return c.reduce(function(d,e){d[e.name]=e.value;return d},{})};return a})();Validator.InlineErrorRenderer=(function(){function a(){}a.fn=a.prototype;a.fn.render=function(c){var d=c.errors.all();for(var b in d){this._renderError(c,b,d[b])}};a.fn.clean=function(b){b.form.find(".error").remove()};a.fn._renderError=function(d,c,e){var b=$("<span>").addClass("error").text(e[0]);d.form.find("[name='"+c+"']").after(b)};return a})();Validator.ListRenderer=(function(){function a(b){this.banner=b}a.fn=a.prototype;a.fn.render=function(c){var b=$("<div class='error-messages'>");this._renderBanner(b);this._renderList(b,c.errors.all());c.form.prepend(b)};a.fn.clean=function(b){b.form.find(".error-messages").remove()};a.fn._renderBanner=function(b){$("<p>").text(this.banner).appendTo(b)};a.fn._renderList=function(b,e){var d=$("<ul>").appendTo(b);for(var c in e){e[c].forEach(function(f){$("<li>").text(f).appendTo(d)})}};return a})();Validator.ContainerRenderer=(function(){function a(){}a.fn=a.prototype;a.fn.render=function(c){var d=c.errors.all();for(var b in d){c.form.find("input[name='"+b+"']").parent().addClass("with-error")}};a.fn.clean=function(b){b.form.find(".with-error").removeClass("with-error")};return a})();